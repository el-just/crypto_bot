2018-01-12T14:11:59.759657: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 25, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 13, in verify_period
    now = datetime.datetime.now()
NameError: name 'datetime' is not defined

2018-01-12T14:12:27.895471: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 26, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 13, in verify_period
    now = datetime.datetime.now()
NameError: name 'datetime' is not defined

2018-01-12T14:13:01.188800: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 25, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 13, in verify_period
    now = datetime.datetime.now()
NameError: name 'datetime' is not defined

2018-01-12T14:13:24.097090: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 26, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 14, in verify_period
    now = datetime.datetime.now()
NameError: name 'datetime' is not defined

2018-01-12T14:16:47.726451: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 25, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 13, in verify_period
    now = datetime.datetime.now()
NameError: name 'datetime' is not defined

2018-01-12T14:18:12.497927: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 17, in verify_period
    'start':time.mktime((now - datetime.timedelta (days=DEFINES.REQUIRED_PERIOD)).timetuple()),
NameError: name 'time' is not defined

2018-01-12T14:18:47.759453: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 28, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 19, in verify_period
    'end': time.mktime(now.timetuple())
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\storage.py", line 44, in get_missing_periods
    missing_periods_sql = self.get_sql ('missing_periods')
TypeError: get_sql() takes 1 positional argument but 2 were given

2018-01-12T14:19:12.330910: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 28, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 19, in verify_period
    'end': time.mktime(now.timetuple())
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\storage.py", line 50, in get_missing_periods
    if time.mktime(available_data[0][0].timetuple()) - start > DEFINES.MISS_PERIOD:
TypeError: unsupported operand type(s) for -: 'float' and 'dict'

2018-01-12T14:21:30.024678: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 28, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 22, in verify_period
    for period in periods:
NameError: name 'periods' is not defined

2018-01-12T14:25:25.942268: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 28, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 19, in verify_period
    'end': time.mktime(now.timetuple())
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\storage.py", line 47, in get_missing_periods
    if len (available_data) > 0:
NameError: name 'available_data' is not defined

2018-01-12T14:55:37.058403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 53, in get_tick_period
    period_pure_data = await self._request (self._url + self._tick_period_url, params)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 25, in _request
    request = pd.Series (data=[url+urllib.parse.urlencode(params)], index=['request'])
NameError: name 'urllib' is not defined

2018-01-12T14:55:56.731403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 56, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 64, in _parse_data
    raise Warning ('asd')
Warning: asd

2018-01-12T14:56:33.393403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 56, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 65, in _parse_data
    raise Warning ('asd')
Warning: asd

2018-01-12T14:57:06.209403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 56, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 65, in _parse_data
    raise Warning ('asd')
Warning: asd

2018-01-12T15:08:54.125403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 56, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 65, in _parse_data
    raise Warning ('asd')
Warning: asd

2018-01-12T15:13:31.063403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 56, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 65, in _parse_data
    raise Warning ('asd')
Warning: asd

2018-01-12T15:15:56.682403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 57, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 65, in _parse_data
    tick = pd.Series (data=[int(tick_data[0][:-3]), 'btc', 'usd', ], index=['timestamp', 'base', 'quot', 'close', 'volume'])
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\pandas\core\series.py", line 266, in __init__
    data = SingleBlockManager(data, index, fastpath=True)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\pandas\core\internals.py", line 4397, in __init__
    fastpath=True)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\pandas\core\internals.py", line 2952, in make_block
    return klass(values, ndim=ndim, fastpath=fastpath, placement=placement)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\pandas\core\internals.py", line 2077, in __init__
    placement=placement, **kwargs)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\pandas\core\internals.py", line 120, in __init__
    len(self.mgr_locs)))
ValueError: Wrong number of items passed 3, placement implies 5

2018-01-12T15:23:47.379403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 57, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 66, in _parse_data
    frame = frame.append (tick)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\pandas\core\frame.py", line 5141, in append
    raise TypeError('Can only append a Series if ignore_index=True'
TypeError: Can only append a Series if ignore_index=True or if the Series has a name

2018-01-12T15:24:32.764403: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 27, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 23, in verify_period
    tick_frame = await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 57, in get_tick_period
    period_frame = self._parse_data (period_pure_data)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 69, in _parse_data
    raise Warning ('asd')
Warning: asd

2018-01-12T16:55:08.950381: Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 9, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 31, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 28, in verify_period
    await self._rest_socket.get_tick_period (period)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\rest_socket.py", line 63, in get_tick_period
    await self._storage.insert_tick_frame (tick_period_frame)
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\storage.py", line 39, in insert_tick_frame
    await self_socket.execute ('''INSERT INTO tb.ticker (tick_date, tick_time, base, quot, close, volume) VALUES''', rows)
NameError: name 'self_socket' is not defined

2018-01-12T18:25:32.208075: 'default_miss_time'
Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 8, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 34, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 26, in verify_period
    'end': time.mktime(now.timetuple())
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\storage.py", line 47, in get_missing_periods
    available_data = await self._socket.execute (missing_periods_sql.format(base='btc', quot='usd', start=period['start'], end=period['end']))
KeyError: 'default_miss_time'
2018-01-12T18:28:06.019075: Code: 210. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение (localhost:9000)
Traceback (most recent call last):
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\clickhouse_driver\connection.py", line 177, in connect
    self.socket = self._create_socket()
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\clickhouse_driver\connection.py", line 164, in _create_socket
    raise err
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\clickhouse_driver\connection.py", line 155, in _create_socket
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\_Folder\private\dev\tb\init.py", line 8, in <module>
    loop.run_until_complete(Bitfinex().run())
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\asyncio\base_events.py", line 467, in run_until_complete
    return future.result()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 34, in run
    await self.verify_period ()
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\__init__.py", line 26, in verify_period
    'end': time.mktime(now.timetuple())
  File "D:\_Folder\private\dev\tb\stocks\bitfinex\storage.py", line 47, in get_missing_periods
    available_data = await self._socket.execute (missing_periods_sql.format(base='btc', quot='usd', start=period['start'], end=period['end'], default_miss_time=DEFINES.MISS_PERIOD))
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\aioch\client.py", line 92, in execute
    **kwargs)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\concurrent\futures\thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\clickhouse_driver\client.py", line 159, in execute
    self.connection.force_connect()
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\clickhouse_driver\connection.py", line 122, in force_connect
    self.connect()
  File "C:\Users\au.pohila\AppData\Local\Programs\Python\Python36-32\lib\site-packages\clickhouse_driver\connection.py", line 202, in connect
    '{} ({})'.format(e.strerror, self.get_description())
clickhouse_driver.errors.NetworkError: Code: 210. Подключение не установлено, т.к. конечный компьютер отверг запрос на подключение (localhost:9000)
